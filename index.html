<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Infinite Pickaxe Miner</title>
<style>
body { margin: 0; overflow: hidden; }
canvas { display: block; margin: 0 auto; }
</style>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
</head>
<body>
<script>
const config = {
    type: Phaser.AUTO,
    width: 400,
    height: 600,
    backgroundColor: '#87CEEB',
    physics: { default: 'arcade', arcade: { gravity: { y: 0 } } },
    scene: { preload: preload, create: create, update: update }
};

const game = new Phaser.Game(config);

let blocks;
let pickaxe;
let blockSize = 50;
let speed = 0.5; // slow downward movement
let bouncing = false; // flag to prevent multiple bounces at once

const oreTypes = [
    { name: 'stone', color: 0x808080 },
    { name: 'iron', color: 0xD8BFD8 },
    { name: 'gold', color: 0xFFD700 },
    { name: 'diamond', color: 0x00FFFF },
    { name: 'netherite', color: 0x2F4F4F }
];

function preload() {}

function create() {
    blocks = this.add.group();

    for (let i = 0; i < 20; i++) {
        addBlock(this, i);
    }

    pickaxe = this.add.rectangle(200, 100, 40, 40, 0xFF0000);
    this.physics.add.existing(pickaxe);

    // Camera follows pickaxe
    this.cameras.main.startFollow(pickaxe, true, 0.1, 0.1);
}

function addBlock(scene, index) {
    const ore = Phaser.Math.RND.pick(oreTypes);
    const x = 200;
    const y = pickaxe.y + 600 - index * blockSize;
    const block = scene.add.rectangle(x, y, blockSize, blockSize, ore.color);
    block.oreType = ore.name;
    blocks.add(block);
}

function update() {
    // Move pickaxe down slowly
    pickaxe.y += speed;

    blocks.getChildren().forEach(block => {
        block.y -= speed;

        // Remove blocks above camera
        if (block.y < pickaxe.y - 650) {
            block.destroy();
            addBlock(this, 0);
        }

        // Check collision
        if (Phaser.Geom.Intersects.RectangleToRectangle(pickaxe.getBounds(), block.getBounds())) {
            block.destroy();

            // Bounce pickaxe up once
            if (!bouncing) {
                bouncing = true;
                this.tweens.add({
                    targets: pickaxe,
                    y: pickaxe.y - 30, // move up 30 pixels
                    duration: 100,
                    yoyo: true, // come back down
                    ease: 'Power1',
                    onComplete: () => { bouncing = false; }
                });
            }
        }
    });
}

// TNT / Nuke
function triggerTNT() {
    console.log('TNT triggered!');
    blocks.getChildren().forEach(block => {
        if (block.y > pickaxe.y && block.y < pickaxe.y + 250) block.destroy();
    });
}

function triggerNuke() {
    console.log('NUKE triggered!');
    blocks.getChildren().forEach(block => block.destroy());
}
</script>
</body>
</html>
